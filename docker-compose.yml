name: ft_transcendence

include:
  - ./backend/compose-backend.yml
  - ./elk/compose-elk.yml

services:
  frontend:
    container_name: frontend
    networks:
      - backend
    depends_on:
      - gateway
    build:
      context: ./frontend
    expose:
      - 80
    restart: unless-stopped

  reverse-proxy:
    container_name: reverse_proxy
    networks:
      - backend
    depends_on:
      - frontend
      - gateway
    build:
      context: ./reverse-proxy
    ports:
      - 8080:80
      - 4443:443
    restart: unless-stopped


volumes:
  certs:
    driver: local
  esdata01:
    driver: local
  kibanadata:
    driver: local
  logstashdata:
    driver: local
  logstash-keystore:
  filebeatdata:
    driver: local
  app_logs:
    driver: local

networks:
  backend:
    driver: bridge
  elk:
    driver: bridge
